<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Detetive — Crime na Mansão</title>
  <style>
    :root{--accent:#6c5ce7;--muted:#6b7280}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, Arial; margin:0;background:#0f1724;color:#ecf0f3}
    header{padding:18px 20px;background:linear-gradient(180deg,#111827,#0b1220);display:flex;align-items:center;gap:16px}
    h1{margin:0;font-size:20px;font-weight:600}
    .toolbar{display:flex;gap:8px;align-items:center;margin-left:auto}
    select,button{padding:8px 10px;border-radius:8px;border:0;background:#fff;color:#0b1220;cursor:pointer}
    button.ghost{background:transparent;color:#fff;border:1px solid rgba(255,255,255,.06)}
    main{display:grid;grid-template-columns:1fr 360px;gap:18px;padding:18px}
    .panel{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));padding:14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03)}
    .rooms{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}
    .room{padding:12px;border-radius:8px;background:rgba(255,255,255,0.02);cursor:pointer;border:1px solid rgba(255,255,255,0.02)}
    .room:hover{transform:translateY(-3px)}
    .room.visited{opacity:.6}
    .room h3{margin:0 0 6px;font-size:16px}
    .flex{display:flex;gap:8px;align-items:center}
    .sidebar{display:flex;flex-direction:column;gap:12px}
    .notebook{min-height:140px;max-height:360px;overflow:auto}
    .suspect{display:flex;align-items:center;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(0,0,0,0.15);margin-bottom:6px}
    .suspect .left{display:flex;gap:8px;align-items:center}
    .avatar{width:44px;height:44px;border-radius:8px;background:rgba(255,255,255,0.06);display:flex;align-items:center;justify-content:center;font-weight:700}
    .small{font-size:12px;color:var(--muted)}
    .clue{padding:8px;border-radius:8px;background:rgba(0,0,0,0.12);margin-bottom:8px}
    .controls{display:flex;gap:8px}
    footer.instructions{padding:12px;background:linear-gradient(180deg,rgba(255,255,255,0.01),transparent);border-top:1px dashed rgba(255,255,255,0.02);margin-top:8px;border-radius:8px}
    .badge{background:var(--accent);color:#fff;padding:4px 8px;border-radius:999px;font-size:12px}
    .modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:999}
    .card{background:#071025;padding:16px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);width:420px}
    label{display:block;margin-bottom:6px}
    select,input{width:100%;padding:8px;border-radius:6px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#fff}
    .hint{background:#f6e58d;color:#111;padding:6px;border-radius:6px}
    @media(max-width:980px){main{grid-template-columns:1fr} .sidebar{order:2}}
  </style>
</head>
<body>
  <header>
    <h1>Detetive — Crime na Mansão</h1>
    <div class="toolbar">
      <label class="small">Dificuldade
        <select id="difficulty">
          <option value="easy">Fácil</option>
          <option value="medium" selected>Médio</option>
          <option value="hard">Difícil</option>
        </select>
      </label>
      <label class="small">Temas
        <select id="pool">
          <option value="conhecidos">Conhecidos</option>
          <option value="lol">League of Legends</option>
          <option value="mix">Mix</option>
        </select>
      </label>
      <button id="newGame">Nova Partida</button>
      <button id="hint" class="ghost">Pedir Dica</button>
      <button id="reveal" class="ghost">Revelar Solução</button>
    </div>
  </header>

  <main>
    <section>
      <div class="panel">
        <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:12px">
          <div>
            <div class="small">Mansão</div>
            <strong id="status">A investigar...</strong>
            <div class="small" id="meta"></div>
          </div>
          <div class="flex">
            <div class="badge" id="score">0 pistas</div>
          </div>
        </div>

        <div id="rooms" class="rooms"></div>

        <div style="margin-top:12px;display:flex;gap:8px;align-items:center">
          <div style="flex:1">
            <label>Acusar</label>
            <div style="display:flex;gap:8px">
              <select id="accuseSuspect"></select>
              <select id="accuseWeapon"></select>
              <select id="accuseLocation"></select>
              <button id="accuseBtn">Acusar</button>
            </div>
          </div>
        </div>

        <div class="instructions" style="margin-top:10px">
          <div class="small">Como jogar — instruções dentro do jogo</div>
          <div style="margin-top:8px;font-size:13px">
            1) Clique em <strong>Nova Partida</strong> para gerar um crime aleatório.<br>
            2) Explore as salas clicando em cada cartão para revelar pistas (algumas são enganosas!).<br>
            3) Interrogue os suspeitos no painel à direita para ouvir álibis e contradições.<br>
            4) Use o caderno para revisar pistas, marque suspeitos e, quando tiver certeza, faça a acusação (suspeito + arma + local).<br>
            5) Se errar, você pode tentar novamente, mas cada erro diminui suas "pistas" (opcional). Boa sorte, detetives!
          </div>
        </div>

      </div>
    </section>

    <aside class="sidebar">
      <div class="panel">
        <h3>Caderno</h3>
        <div class="notebook" id="notebook">Nenhuma pista ainda. Comece uma nova partida e explore as salas.</div>
        <div style="margin-top:8px">
          <button id="exportNotes" class="ghost">Exportar anotações</button>
        </div>
      </div>

      <div class="panel">
        <h3>Suspeitos</h3>
        <div id="suspectsList">—</div>
        <div style="margin-top:8px">
          <div class="small">Interrogue para obter álibis. Marque quem o(a) deixou mais suspeito(a).</div>
        </div>
      </div>

      <div class="panel">
        <h3>Histórico</h3>
        <div id="log"></div>
      </div>

      <footer class="instructions panel">
        <strong>Instruções completas</strong>
        <ol style="padding-left:18px;margin-top:8px;color:#cbd5e1">
          <li>Comece nova partida e selecione tema/dificuldade antes.</li>
          <li>Vá sala a sala — cada sala contém uma pista (você adiciona ao caderno).</li>
          <li>Interrogue suspeitos — cada um tem um álibi; compare com pistas.</li>
          <li>Acuse corretamente (suspeito + arma + local) para ganhar. Há pistas verdadeiras e falsas.</li>
          <li>Pedir dica revela UMA pista extra que aponta para o culpado.</li>
        </ol>
      </footer>
    </aside>
  </main>

  <!-- modal -->
  <div id="modal" style="display:none" class="modal">
    <div class="card" id="modalCard"></div>
  </div>

  <script>
    // Dados (listas) — você pode editar os nomes aqui se quiser
    const known = ["Matheus","Mika","Dalva","Silvana","Luciano","Mariana","Davi","Calvo do boa noite","Vó regina","Vó Sônia","Alanzoca","Arthur","Celbit","Felps","Faker","Bomba","Nina","Fernando","Vitória","Pezinho","Auau","WW","Neco","Camunga","Esnoob","Kami","Ariane","Filho do pai do Pedro","Bolsonaro","Lula","Gabriel","Ericka Hilton","Nicolas Ferreira","Wesley"];

    const lol = ["Aatrox","Ahri","Akali","Akshan","Alistar","Ambessa","Amumu","Anivia","Annie","Aphelios","Ashe","Aurelion Sol","Aurora","Azir","Bard","Bel’Veth","Blitzcrank","Brand","Braum","Briar","Caitlyn","Camille","Cassiopeia","Cho’Gath","Corki","Darius","Diana","Dr. Mundo","Draven","Ekko","Elise","Evelynn","Ezreal","Fiddlesticks","Fiora","Fizz","Galio","Gangplank","Garen","Gnar","Gragas","Graves","Gwen","Hecarim","Heimerdinger","Hwei","Illaoi","Irelia","Ivern","Janna","Jarvan IV","Jax","Jayce","Jhin","Jinx","Kai’Sa","Kalista","Karma","Karthus","Kassadin","Katarina","Kayle","Kayn","Kennen","Kha’Zix","Kindred","Kled","Kog’Maw","LeBlanc","Lee Sin","Leona","Lillia","Lissandra","Lucian","Lulu","Lux","Malphite","Malzahar","Maokai","Master Yi","Mel","Milio","Miss Fortune","Mordekaiser","Morgana","Naafiri","Nami","Nasus","Nautilus","Neeko","Nidalee","Nilah","Nocturne","Nunu & Willump","Olaf","Orianna","Ornn","Pantheon","Poppy","Pyke","Qiyana","Quinn","Rakan","Rammus","Rek’Sai","Rell","Renata Glasc","Renekton","Rengar","Riven","Rumble","Ryze","Samira","Sejuani","Senna","Seraphine","Sett","Shaco","Shen","Shyvana","Singed","Sion","Sivir","Skarner","Smolder","Sona","Soraka","Swain","Sylas","Syndra","Tahm Kench","Taliyah","Talon","Taric","Teemo","Thresh","Tristana","Trundle","Tryndamere","Twisted Fate","Twitch","Udyr","Urgot","Varus","Vayne","Veigar","Vel’Koz","Vex","Vi","Viego","Viktor","Vladimir","Volibear","Warwick","Wukong","Xayah","Xerath","Xin Zhao","Yasuo","Yone","Yorick","Yuumi","Yunara","Zac","Zed","Zeri","Ziggs","Zilean","Zoe","Zyra"];

    const weapons = ["Faca", "Revólver", "Corda", "Castigador (cajado)", "Pedaço de madeira", "Veneno" , "Cantilheira", "Pano pesado"]; // misto
    const rooms = ["Cozinha","Biblioteca","Jardim","Garagem","Sala de Estar","Quarto Principal","Escritório","Terraço","Sala de Jantar","Porão"];

    // Estado do jogo
    let suspects = [];
    let culprit = null;
    let crimeWeapon = null;
    let crimeLocation = null;
    let clues = []; // {room, text, trueFor: 'nome' or 'attribute', pointsToName?, isTruth}
    let notebook = [];
    let visitedRooms = new Set();
    let score = 0;
    let hintsUsed = 0;

    // Helpers
    function randPick(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
    function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a }

    // Gera suspeitos com atributos aleatórios
    function generateSuspects(poolNames, count){
      const hair = ["preto","loiro","ruivo","castanho","grisalho"];
      const clothes = ["vermelho","azul","preto","branco","verde","amarelo"];
      const hobby = ["fotografia","jardinagem","jogar videogame","cozinhar","costura","cantar","marcenaria"];
      const pet = ["cachorro","gato","nenhum","papagaio","peixe"];
      const shoes = ["vermelho","azul","preto","branco","marrom"];
      const professions = ["professor","mecânico","programador","designer","estudante","advogado","barista"];

      const names = shuffle(poolNames.slice()).slice(0,count);
      return names.map(n=>({
        nome:n,
        hair:randPick(hair),
        clothes:randPick(clothes),
        hobby:randPick(hobby),
        pet:randPick(pet),
        shoes:randPick(shoes),
        profession:randPick(professions),
        alibi:randPick(rooms)
      }));
    }

    // Cria pistas: pelo menos 3 verdadeiras apontando pro culpado, e algumas falsas
    function generateClues(){
      clues = [];
      visitedRooms = new Set();
      const trueClues = [];
      // usar atributos do culpado
      trueClues.push({text:`Uma testemunha viu alguém com cabelo ${culprit.hair} perto da ${crimeLocation}.`,isTruth:true});
      trueClues.push({text:`Foi encontrada uma pegada com sapato ${culprit.shoes} no chão do local do crime.`,isTruth:true});
      trueClues.push({text:`Alguém encontrou um objeto relacionado ao hobby: ${culprit.hobby} em um canto próximo.`,isTruth:true});

      // adicionar pequenas variações
      trueClues.push({text:`Um bilhete rasgado mencionava a profissão: ${culprit.profession}.`,isTruth:true});

      // falsas (red herrings) apontando a outros suspeitos
      const others = suspects.filter(s=>s.nome!==culprit.nome);
      shuffle(others);
      const falseClues = [];
      if(others[0]) falseClues.push({text:`Um vizinho disse ter visto ${others[0].nome} saindo da ${randPick(rooms)} naquela noite.` , isTruth:false});
      if(others[1]) falseClues.push({text:`Foram encontradas manchas de tinta que combinam com a roupa de ${others[1].nome}.`, isTruth:false});
      if(others[2]) falseClues.push({text:`Um pedaço de tecido que lembra a cor ${others[2].clothes} foi achado próximo à janela.`, isTruth:false});

      // climas/contexto
      const misc = [];
      misc.push({text:`A câmera da rua gravou um carro passando às 22:11 que não voltou ao local.`,isTruth:false});
      misc.push({text:`O relógio da casa estava parado às 22:05.`,isTruth:false});

      // distribuir pistas em salas aleatórias
      const pool = shuffle(rooms.slice());
      const all = shuffle(trueClues.concat(falseClues).concat(misc));
      for(let i=0;i<pool.length;i++){
        const c = all[i%all.length];
        clues.push({room:pool[i],text:c.text,isTruth:c.isTruth});
      }
    }

    function startNewGame(){
      // reset
      notebook = []; clues = []; visitedRooms = new Set(); score = 0; hintsUsed=0;
      document.getElementById('log').innerHTML='';
      document.getElementById('notebook').innerHTML='Nenhuma pista ainda.';
      document.getElementById('score').textContent='0 pistas';

      const diff = document.getElementById('difficulty').value;
      const poolChoice = document.getElementById('pool').value;
      let poolNames = known;
      if(poolChoice==='lol') poolNames = lol;
      if(poolChoice==='mix') poolNames = known.concat(lol);

      const count = diff==='easy'?6: diff==='medium'?8:10;
      suspects = generateSuspects(poolNames,count);
      culprit = randPick(suspects);
      crimeWeapon = randPick(weapons);
      crimeLocation = randPick(rooms);
      generateClues();

      // atualizar UI
      renderRooms();
      renderSuspects();
      populateAccuseOptions();
      document.getElementById('status').textContent='O crime aconteceu. Investigação iniciada.';
      document.getElementById('meta').textContent=`${suspects.length} suspeitos gerados — decisão difícil!`;
      log(`Novo crime: arma gerada e local definidO (oculto).`);
    }

    function renderRooms(){
      const el = document.getElementById('rooms'); el.innerHTML='';
      rooms.forEach(r=>{
        const d = document.createElement('div'); d.className='room';
        if(visitedRooms.has(r)) d.classList.add('visited');
        d.innerHTML = `<h3>${r}</h3><div class='small'>Clique para investigar</div>`;
        d.addEventListener('click', ()=> openRoom(r));
        el.appendChild(d);
      });
    }

    function openRoom(roomName){
      if(!clues || clues.length===0){ alert('Comece uma nova partida primeiro.'); return; }
      const c = clues.find(x=>x.room===roomName);
      visitedRooms.add(roomName);
      renderRooms();
      showModal(`<h3>${roomName}</h3><p class='clue'>${c ? c.text : 'Nada relevante encontrado.'}</p><div style="display:flex;gap:8px;margin-top:10px"><button id='takeClue'>Anotar pistas</button><button id='closeRoom' class='ghost'>Fechar</button></div>`);
      document.getElementById('takeClue')?.addEventListener('click', ()=>{ if(c) addClue(c); closeModal(); });
      document.getElementById('closeRoom')?.addEventListener('click', ()=> closeModal());
      log(`Investigou: ${roomName}`);
    }

    function addClue(clue){
      notebook.push(clue);
      updateNotebook();
      score = notebook.length;
      document.getElementById('score').textContent=`${score} pistas`;
      log(`Anotou pista: ${clue.text}`);
    }

    function updateNotebook(){
      const el = document.getElementById('notebook');
      if(notebook.length===0){ el.innerHTML='Nenhuma pista ainda.'; return; }
      el.innerHTML = '';
      notebook.forEach((n,i)=>{
        const d = document.createElement('div'); d.className='clue';
        d.innerHTML = `<div><strong>Pista ${i+1}:</strong> ${n.text}</div><div class='small'>${n.isTruth?'<em>Possivelmente verdadeira</em>':''}</div>`;
        el.appendChild(d);
      });
    }

    function renderSuspects(){
      const el = document.getElementById('suspectsList'); el.innerHTML='';
      suspects.forEach((s,idx)=>{
        const d = document.createElement('div'); d.className='suspect';
        d.innerHTML = `<div class='left'><div class='avatar'>${s.nome[0]}</div><div><strong>${s.nome}</strong><div class='small'>Profissão: ${s.profession} — Álibi: ${s.alibi}</div></div></div><div style='display:flex;flex-direction:column;gap:6px'><button data-idx='${idx}' class='interrogate'>Interrogar</button><button data-idx='${idx}' class='mark ghost'>Marcar</button></div>`;
        el.appendChild(d);
      });
      // attach events
      document.querySelectorAll('.interrogate').forEach(b=>b.addEventListener('click', e=>{
        const i = +e.currentTarget.dataset.idx; interrogate(i);
      }));
      document.querySelectorAll('.mark').forEach(b=>b.addEventListener('click', e=>{
        const i = +e.currentTarget.dataset.idx; toggleMark(i,e.currentTarget);
      }));
    }

    function interrogate(i){
      const s = suspects[i];
      // montar declaração; culprits mentem no álibi
      const isCulprit = s.nome===culprit.nome;
      const claimed = isCulprit? randPick(rooms) : s.alibi; // culprits dão falso álibi
      let statement = `${s.nome} diz: "Eu estava no(a) ${claimed} na hora do crime."`;
      // adicionar comentário sobre ter visto alguém
      const witness = randPick(suspects.filter(x=>x.nome!==s.nome));
      statement += ` Também disse ter visto ${witness.nome} com roupas ${witness.clothes} próximo à mansão.`;
      // apresentar
      showModal(`<h3>Interrogatório — ${s.nome}</h3><p>${statement}</p><div style='margin-top:10px;display:flex;gap:8px'><button id='noteStatement'>Anotar</button><button id='closeI' class='ghost'>Fechar</button></div>`);
      document.getElementById('noteStatement').addEventListener('click', ()=>{ addClue({room:'Interrogatório',text:statement,isTruth:!isCulprit}); closeModal(); });
      document.getElementById('closeI').addEventListener('click', ()=> closeModal());
      log(`Interrogou: ${s.nome}`);
    }

    function toggleMark(i,btn){
      const s = suspects[i];
      s.marked = !s.marked;
      btn.classList.toggle('ghost');
      btn.textContent = s.marked? 'Marcado': 'Marcar';
      log(`${s.nome} ${s.marked? 'marcado como suspeito':'desmarcado'}`);
    }

    function populateAccuseOptions(){
      const ssel = document.getElementById('accuseSuspect'); ssel.innerHTML=''; suspects.forEach(s=>{ const op = document.createElement('option'); op.value=s.nome; op.textContent=s.nome; ssel.appendChild(op); });
      const wsel = document.getElementById('accuseWeapon'); wsel.innerHTML=''; weapons.forEach(w=>{ const op=document.createElement('option'); op.value=w; op.textContent=w; wsel.appendChild(op); });
      const lsel = document.getElementById('accuseLocation'); lsel.innerHTML=''; rooms.forEach(r=>{ const op=document.createElement('option'); op.value=r; op.textContent=r; lsel.appendChild(op); });
    }

    function accuse(){
      const s = document.getElementById('accuseSuspect').value;
      const w = document.getElementById('accuseWeapon').value;
      const l = document.getElementById('accuseLocation').value;
      const correct = (s===culprit.nome && w===crimeWeapon && l===crimeLocation);
      if(correct){
        showModal(`<h3>Acusação</h3><p>Parabéns! Vocês solucionaram o crime. <br> Culpado: <strong>${culprit.nome}</strong><br>Arma: <strong>${crimeWeapon}</strong><br>Local: <strong>${crimeLocation}</strong></p><div style='margin-top:12px;display:flex;gap:8px'><button id='newAfter'>Jogar novamente</button></div>`);
        document.getElementById('newAfter').addEventListener('click', ()=>{ closeModal(); startNewGame(); });
        log('Acusação correta. Caso encerrado.');
      } else {
        showModal(`<h3>Acusação</h3><p>Que pena — acusação incorreta. Vocês podem tentar novamente. Dica: revejam o caderno.</p><div style='margin-top:12px;display:flex;gap:8px'><button id='tryAgain'>Continuar investigando</button></div>`);
        document.getElementById('tryAgain').addEventListener('click', ()=> closeModal());
        log('Acusação incorreta.');
      }
    }

    function useHint(){
      if(!clues || clues.length===0){ alert('Comece nova partida primeiro.'); return; }
      if(hintsUsed>=2){ alert('Máximo de dicas usadas.'); return; }
      // pega uma pista verdadeira que não esteja no caderno
      const trueClues = clues.filter(c=>c.isTruth && !notebook.includes(c));
      if(trueClues.length===0){ alert('Nenhuma dica extra disponível.'); return; }
      const hint = randPick(trueClues);
      addClue(hint);
      hintsUsed++;
      showModal(`<h3>Dica</h3><p class='hint'>${hint.text}</p><div style='margin-top:8px'><button id='closeHint'>Ok</button></div>`);
      document.getElementById('closeHint').addEventListener('click', ()=> closeModal());
      log('Usou uma dica.');
    }

    function revealSolution(){
      showModal(`<h3>Solução revelada</h3><p>Culpado: <strong>${culprit.nome}</strong><br>Arma: <strong>${crimeWeapon}</strong><br>Local: <strong>${crimeLocation}</strong></p><div style='margin-top:12px'><button id='closeReveal'>Fechar</button></div>`);
      document.getElementById('closeReveal').addEventListener('click', ()=> closeModal());
      log('Solução foi revelada (usuário solicitou).');
    }

    // modal helpers
    function showModal(html){ document.getElementById('modalCard').innerHTML = html; document.getElementById('modal').style.display='flex'; }
    function closeModal(){ document.getElementById('modal').style.display='none'; document.getElementById('modalCard').innerHTML=''; }

    function log(text){ const el = document.getElementById('log'); const d = document.createElement('div'); d.className='small'; d.textContent = `[${new Date().toLocaleTimeString()}] ${text}`; el.prepend(d); }

    document.getElementById('newGame').addEventListener('click', ()=> startNewGame());
    document.getElementById('accuseBtn').addEventListener('click', ()=> accuse());
    document.getElementById('hint').addEventListener('click', ()=> useHint());
    document.getElementById('reveal').addEventListener('click', ()=> revealSolution());
    document.getElementById('exportNotes').addEventListener('click', ()=>{
      if(notebook.length===0) return alert('Nada para exportar.');
      const txt = notebook.map((n,i)=>`Pista ${i+1}: ${n.text}`).join('\n');
      navigator.clipboard?.writeText(txt).then(()=> alert('Notas copiadas para a área de transferência.'));
    });

    // start default
    startNewGame();

  </script>
</body>
</html>